# 個人向けコーヒー豆管理アプリ 要件定義（提案）

> メモ: リポジトリ内に AGENT.md が見つからなかったため、一般的なプロダクト要件テンプレートとご要望（独自ビジュアライザ、産地・焙煎・お店・感想などの記録）に基づき定義しています。AGENT.md の方針があれば共有いただければ整合させます。

## 1. 概要 / 目的
- 自分のコーヒー豆・淹れ方・味の好みを“定量・定性”で記録・可視化し、次の購入やレシピ改善に活かせる個人管理アプリ。
- 特徴は「他にはないビジュアライザ」による発見性の高いフィードバックと、産地・焙煎・お店・感想の一元管理。

## 2. スコープ
- 対象ユーザー: 家庭でコーヒーを楽しむ個人、ライト〜ミドルの愛好家。
- プラットフォーム: モバイル優先（PWA も視野）/ Web。
- データ: ローカル保存を基本、任意でクラウド同期（将来）。

## 3. ゴール / 非ゴール
- ゴール
  - 豆バッチ単位の在庫と履歴を管理。
  - 産地・品種・精製・焙煎度・購入店・価格・ロースト日などを記録。
  - 抽出（レシピ）とテイスティング（感想・フレーバー）を記録。
  - 独自ビジュアライザで「好み・結果・在庫」を直感把握。
- 非ゴール（初期）
  - EC/購入機能の実装。
  - 業務用在庫/会計管理。
  - 複雑なコミュニティ機能（共有は将来検討）。

## 4. ペルソナ（簡易）
- 記録派: 豆の比較検討がしたい、再現性を高めたい。
- 探究派: 産地・焙煎・抽出条件を深掘りし、傾向を可視化したい。
- カジュアル派: 在庫把握と簡単メモ、次回の参考になれば良い。

## 5. ユーザーストーリー
- 豆を買ったら、産地・焙煎度・お店・価格・ロースト日をサッと登録できる。
- 朝淹れたレシピ（グラム数・温度・抽出時間）と味の感想を数タップで記録できる。
- 好みの傾向（酸・甘・ボディ）や、よく当たるレシピの組み合わせを可視化で発見できる。
- 在庫が少なくなった豆に気づけ、リピート候補が分かる。
- 産地マップや焙煎度の推移で、自分の嗜好の変化を振り返れる。

## 6. 機能要件（MVP優先順）
1) 豆バッチ管理（在庫）
- 追加/編集/アーカイブ、現在量・初期量・単位（g）
- 価格・購入日・消費期限・ロースト日
- タグ（例: デイリー/スペシャル）

2) 産地/焙煎/お店情報
- 産地（国・地域・農園/コープ名）、品種、精製方法
- 焙煎度（段階/数値）、焙煎日、ロースター名
- 購入店（オンライン/店舗）、リンク、再購入用メモ

3) 抽出レシピ記録
- メソッド（ハンドドリップ/エスプレッソ等）
- 豆量/挽き目/水量/温度/攪拌/抽出時間
- 使用器具（ミル/ドリッパー/フィルター）

4) テイスティング記録
- 好き度（1-5）＋ 香り/酸っぱさ/苦さ（各1-5）
- 詳細（任意）: 甘さ/ボディ/後味（各1-5）
- フレーバーノート（自由入力 + プリセット）
- 写真（豆/抽出/ラベル）
- 一言感想、改善メモ

5) 検索・フィルタ・並び替え
- 産地/焙煎度/購入店/タグ/好き度/香り/酸っぱさ/苦さ/在庫有無で絞り込み
- 履歴での類似抽出（例: 同ロースター×中煎り）

6) ビジュアライザ（MVP）
- フレーバー・コンステレーション（提案）
  - 軸: フレーバーカテゴリ（果実/ナッツ/チョコ/フローラル/スパイスなど）を円環上に配置
  - 点: 各テイスティング（サイズ=好き度、色=焙煎度、明度=抽出メソッド）
  - インタラクション: タップで詳細、期間/豆/ロースターでフィルタ
  - 目的: 「自分の当たり傾向」「豆×抽出の相性」を直感抽出
- 補助: 産地マップ（ピン=購入/試飲回数、色=平均評価）

7) データの入出力
- JSON/CSV エクスポート（バックアップ）
- インポート（同フォーマット）

8) 通知（任意 ON）
- 焙煎後ピーク推定日リマインド、在庫残量しきい値通知

## 7. 非機能要件
- パフォーマンス: 主要操作は体感 <200ms、一覧は遅延読み込み
- オフライン: 参照と主要記録はオフライン可（PWA/ローカルDB）
- データ保護: ローカル優先、端末ロック/簡易PIN。クラウド同期は将来の任意機能
- アクセシビリティ: 音声読み上げ、十分なコントラスト、タップ領域確保
- 多言語: 日本語優先、英語対応を見据えた設計

## 8. データモデル（初期案）
- BeanBatch（豆バッチ）
  - id, name, roaster, roast_level, roast_date, origin_country, origin_region, farm, variety, process, purchase_shop_id, purchase_date, price, initial_weight_g, current_weight_g, notes, tags[]
- Shop（購入店/ロースター）
  - id, name, type(enum: shop/roaster/online), url, address, memo
- Brew（抽出）
  - id, bean_batch_id, method(enum), dose_g, grind, water_g, temperature_c, time_sec, agitation, equipment[], date
- Tasting（テイスティング）
  - id, brew_id, liking(1-5), aroma(1-5), sourness(1-5), bitterness(1-5), sweetness(1-5, optional), body(1-5, optional), aftertaste(1-5, optional), flavor_notes[], comment, photos[]
- InventoryLog（在庫変動）
  - id, bean_batch_id, delta_g, reason(enum: brew/adjust/other), at
- Tag
  - id, label, color

関係:
- BeanBatch 1 - n Brew - 1 Tasting（1:1 も可）
- BeanBatch 1 - n InventoryLog
- BeanBatch n - 1 Shop

## 9. 画面（MVP）
- ダッシュボード: 在庫サマリ、最近の抽出、ビジュアライザ入口
- 豆一覧/詳細: メタ情報 + 在庫推移 + 関連抽出/評価
- 追加フロー: 豆→抽出→テイスティングをシームレス登録（ステップ短縮）
- 可視化: コンステレーション + 産地マップ（フィルタ/期間切替）
- 検索フィルタ: 絞り込み保存、よく使う条件のピン留め

## 10. 独自ビジュアライザ 詳細（拡張）
- バリエーション案
  - コンステレーション: 好みの星座化（MVP）
  - ロースト・ジャーニーマップ: 産地→精製→焙煎→抽出→味を流れ図で可視化
  - アロマホイール・タイムライン: 時系列でホイールを重ね、嗜好の変化を比較
- 技術要件（描画）
  - WebGL/SVG（端末性能に応じて自動選択）、1,000点規模でも60fps目標
  - インタラクティブフィルタ、ピンチズーム、スナップショット共有

## 11. アナリティクス（ローカル）
- 当たりレシピ推奨: 過去トップ評価の条件を抽出（豆/抽出メソッド別）
- コスト把握: g あたり単価、月次消費量
- リピート候補: 平均評価×在庫×入手性で提示（購入店メモと連携）

## 12. リスク/前提
- 入力負荷が高いと定着しない → ショートカット・テンプレ・前回コピー必須
- 画像保存の容量 → 画質調整/遅延アップロード/端末保存優先
- 同期は複雑 → 初期はローカル完結、後からオプトイン同期

## 13. リリース計画
- MVP（4〜6週間想定）
  - 豆バッチ管理/抽出/テイスティング/在庫、検索、エクスポート、コンステレーション、産地マップ（簡易）
- v1.1
  - 通知、レシピテンプレ、保存フィルタ、写真編集
- v1.2
  - ロースト・ジャーニーマップ、簡易レコメンド

## 14. 計測と品質
- 端末内メトリクス: 画面滞在/完了率/入力時間（匿名・ローカル）
- パフォーマンス計測: 初期表示、可視化FPS、入力応答
- 不具合報告: ローカルログ + 任意送信

---
この要件定義はベースラインです。AGENT.md の方針や、こだわりたい可視化仕様があれば反映します。
